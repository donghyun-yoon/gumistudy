# 정규화(Normalization)

## 목차

- [1. 정규화란](#1-정규화란)
- [2. 제1정규화](#2-제1정규화)
- [3. 제2정규화](#3-제2정규화)
- [4. 제3정규화](#4-제3정규화)
- [5. BCNF](#5-bcnf)
- [6. Reference](#6-reference)

<hr>

## 1. 정규화란

> 관계형 데이터베이스에서 **중복을 최소화**하도록 설계한 데이터베이스

**정규화의 목적**

- 불필요한 데이터를 제거하여 **중복을 최소화**
- 삽입/갱신/삭제 시 발생할 수 있는 **각종 이상 현상(Anomaly)을 방지**하기 위해서 테이블의 구성을 논리적이고 직관적으로 설계

**이상 현상(Anomaly)**

- 삽입 이상(Insertion Anomaly) : 원하지 않는 자료가 삽입되거나, 삽입하는데 자료가 부족해서 삽입이 되지 않아 발생하는 문제점
- 삭제 이상(Deletion Anomaly) : 하나의 자료만 삭제하고 싶은데, 그 자료가 포함된 튜플 전체가 삭제됨으로써 원하지 않는 정보 손실이 발생하는 문제점
- 갱신 이상(Modification Anomaly) : 정확하지 않거나 일부 튜플만 갱신되어 정보가 모호해지거나 일관성이 없어져서 정확한 정보 파악이 되지 않아 발생하는 문제점

**장점**

- 데이터베이스 변경 시 이상 현상 제거
- 데이터베이스 구조 확장 시 재디자인 최소화
- 사용자에게 데이터 모델을 더욱 의미있게 제공

**단점**

```
릴레이션의 분해로 인해 릴레이션 간의 연산(JOIN연산)이 많아져서 질의에 대한 응답 시간이 느려질 수 있다.

조인이 많이 발생하여 성능저하가 나타나는 경우에는 반정규화를 적용하는 것이 좋다.
```

**반정규화(비정규화, 역정규화)**

- 하나 이상의 테이블에 데이터를 중복하여 배치하는 최적화 기법
- 시스템의 성능 향상, 개발 및 운영의 편의성 등을 위해 이미 정규화된 데이터 모델을 통합, 중복, 분리하는 과정으로, **의도적으로 정규화 원칙을 위반**하는 행위를 말함

**정규화의 종류**

> 정규화의 종류로는 제1정규화(1NF), 제2정규화(2NF), 제3정규화(3NF), 보이스-코드(BCNF), 제4정규화(4NF), 제5정규화(5NF)가 있다.

<hr>

## 2. 제1정규화

> 릴레이션에 속한 모든 속성의 도메인이 원자 값으로만 구성되어 있으면 제1정규형에 속한다.

<br>

**상품**

| <U>상품번호</U> | 상품명   | 가격    | 코드  |
| --------------- | -------- | ------- | ----- |
| 101             | TV       | 2000000 | KR    |
| 102             | Computer | 1500000 | CN    |
| 103             | Phone    | 1000000 | KR,JP |

상품 릴레이션에서 한 row에 '코드명' 속성값이 KR, JP로 두개의 값이 존재하므로 제1정규화의 원자성을 만족하지 않는다.

해결 방안

> 상품 릴레이션에서 '코드' 속성만 다른 릴레이션로 나눈 후 두 릴레이션을 M:N 관계로 연결해주는 릴레이션을 추가함으로써 제1정규화가 완료된다.

**상품**

| <U>상품번호</U> | 상품명   | 가격    |
| --------------- | -------- | ------- |
| 101             | TV       | 2000000 |
| 102             | Computer | 1500000 |
| 103             | Phone    | 1000000 |

**상품-국가코드-릴레이션**

| <U>상품번호\_id</U> | <U>국가코드\_id</U> |
| ------------------- | ------------------- |
| 101                 | 1                   |
| 102                 | 2                   |
| 103                 | 1                   |
| 103                 | 3                   |

**국가코드**

| <U>국가코드\_id</U> | 코드 |
| ------------------- | ---- |
| 1                   | KR   |
| 2                   | CN   |
| 3                   | JP   |

<hr>

## 3. 제2정규화

> 제1정규형에 속하면서, 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속이 되면 제2정규형에 속한다.

<br>

**완전 함수 종속**

![](https://t1.daumcdn.net/cfile/tistory/9936004F5B0E51B21B)

![](https://t1.daumcdn.net/cfile/tistory/992C3F4F5B0E51B11C)

**사원**

| <U>사원번호</U> | 사원이름 | 주소    | 전화번호      | 직책 | <U>부서번호</U> | 부서이름 |
| --------------- | -------- | ------- | ------------- | ---- | --------------- | -------- |
| 20121001        | 하정우   | Seoul   | 010-1234-5678 | 사장 | A001            | 총무과   |
| 20121002        | 최민식   | Busan   | 010-5555-5252 | 부장 | A001            | 총무과   |
| 20121003        | 김성균   | Daegu   | 010-2345-6543 | 과장 | B002            | 인사과   |
| 20121004        | 마동석   | Incheon | 010-1541-6411 | 대리 | C003            | 영업과   |
| 20121005        | 곽도원   | Daejeon | 010-4321-0110 | 사원 | D004            | 법무과   |

사원 릴레이션에 있는 2개의 결정자를 모두 종속하는 경우(직책)가 완전 함수적 종속이고 둘 중 하나의 결정자에만 종속되는 경우(사원이름, 주소, 전화번호는 사원번호 / 부서이름은 부서번호)는 부분 함수적 종속

> 사원번호 -> 사원이름, 주소, 전화번호와 부서번호->부서이름 두 개의 부분 함수 종속을 제거하여 다음과 같이 분리하면 제2정규화가 완료된다.

**사원**

| <U>사원번호</U> | 사원이름 | 주소    | 전화번호      |
| --------------- | -------- | ------- | ------------- |
| 20121001        | 하정우   | Seoul   | 010-1234-5678 |
| 20121002        | 최민식   | Busan   | 010-5555-5252 |
| 20121003        | 김성균   | Daegu   | 010-2345-6543 |
| 20121004        | 마동석   | Incheon | 010-1541-6411 |
| 20121005        | 곽도원   | Daejeon | 010-4321-0110 |

**부서**

| <U>부서번호</U> | 부서이름 |
| --------------- | -------- |
| A001            | 총무과   |
| B002            | 인사과   |
| C003            | 영업과   |
| D004            | 법무과   |

**직책**
|<U>사원번호</U>|<U>부서번호</U>|직책|
|-|-|-|
|20121001|A001|사장|
|20121002|A001|부장|
|20121003|B002|과장|
|20121004|C003|대리|
|20121005|D004|사원|

<hr>

## 4. 제3정규화

> 제2정규형에 속하면서, 기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속이 되지 않으면 제3정규형에 속한다.

**이행적 함수 종속**

- 삼단논법 같은 관계를 가진 함수종속
- A, B, C에 대해 A->B 이고 B->C 이면 A->C가 성립하는데 이를 C가 A에 이행적으로 함수 종속 되었다고 함

**학생**

| 학번     | 학과         | 등록금 |
| -------- | ------------ | ------ |
| 22111001 | 컴퓨터공학과 | 400    |
| 21842001 | 경영학과     | 300    |
| 21714567 | 기계공학과   | 450    |
| 21411313 | 컴퓨터공학과 | 400    |

**성적**

| 학번     | 과목코드 | 성적 |
| -------- | -------- | ---- |
| 22111001 | CSE1111  | A    |
| 22111001 | CSE2222  | B+   |
| 22111001 | CSE3333  | A+   |
| 21842001 | MEC1111  | C+   |
| 21714567 | POD1010  | B    |
| 21411313 | CSE3333  | F    |

위 학생 릴레이션에서 함수적 종속성은 다음과 같다.

> 학번 -> 학부<br> 학부 -> 등록금<br> 학번 -> 등록금

> 여기서 학생 릴레이션의 이행적 종속 관계를 제거하여 아래와 같이 분리하면 제3정규화가 완료된다.

**학생**

| <U>학번</U> | 학과         |
| ----------- | ------------ |
| 22111001    | 컴퓨터공학과 |
| 21842001    | 경영학과     |
| 21714567    | 기계공학과   |
| 21411313    | 컴퓨터공학과 |

**학과**

| <U>학과</U>  | 등록금 |
| ------------ | ------ |
| 컴퓨터공학과 | 400    |
| 경영학과     | 300    |
| 기계공학과   | 450    |

<hr>

## 5. BCNF

**BCNF(Boyce-and-Codd)**

> 제3정규형에 속하면서, **모든 결정자가 후보키 집합에 속하면** BCNF에 속한다.

<br>

**학생**

| <U>학번</U> | 과목    | 담당교수 | 학점 |
| ----------- | ------- | -------- | ---- |
| 1001        | CSE1111 | 홍길동   | A    |
| 1002        | CSE2222 | 안중근   | A    |
| 1003        | CSE2222 | 안중근   | A    |

위 학생 릴레이션의 경우 데이터가 중복되고, 갱신 이상이 발생함

> 담당교수는 후보키가 아닌데 결정자로 쓰이고 있으므로 BCNF 조건을 만족하지 않음

> '안중근' 이 강의하는 과목이 바뀐다면 두 개의 row를 갱신해야하는데 이를 해결하기 위해 릴레이션을 분리하면 BCNF가 완료된다.

**교수**

| <U>담당교수</U> | 과목    |
| --------------- | ------- |
| 홍길동          | CSE1111 |
| 안중근          | CSE2222 |

**수강**

| <U>학번</U> | 과목    | 학점 |
| ----------- | ------- | ---- |
| 1001        | CSE1111 | A    |
| 1002        | CSE2222 | A    |
| 1003        | CSE2222 | A    |

<hr>

## 6. Reference

- https://velog.io/@wldus9503/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%A0%95%EA%B7%9C%ED%99%94Normalization%EB%9E%80
- https://owlyr.tistory.com/20
- https://yaboong.github.io/database/2018/03/09/database-normalization-1/
- https://valuefactory.tistory.com/222
